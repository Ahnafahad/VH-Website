# VH Website Testing Guide

## System Overview

The system now supports both IBA and FBS mock tests with proper access control.

## Updated Components

### 1. **Batch File: `update-results.bat`**
   - Processes IBA tests (Simple Tests, Full Tests, IBA Mocks)
   - Processes FBS mocks (DU FBS Mocks)
   - Commits and pushes all changes to GitHub
   - Automatically deploys to Vercel

### 2. **Access Control**
   - **Admins**: Full access to all IBA and FBS tests
   - **IBA Students**: Access to IBA tests only
   - **FBS Students**: Access to FBS tests only
   - **Both**: Access to both IBA and FBS tests

### 3. **API Endpoints**
   - `/api/user/access`: Returns `{hasIBA, hasFBS, isAdmin}`
   - Admins always get `{hasIBA: true, hasFBS: true, isAdmin: true}`

## Testing Checklist

### For Admins:
- [ ] Login and navigate to `/results`
- [ ] Verify you see both "IBA Mock Tests" and "DU FBS Mocks" sections
- [ ] Click on an IBA mock test - should show results
- [ ] Click on a DU FBS mock test - should show FBS-specific passing criteria
- [ ] Verify you can select any student and view their results

### For IBA Students:
- [ ] Login and navigate to `/results`
- [ ] Verify you see "IBA Mock Tests" section
- [ ] Verify you DO NOT see "DU FBS Mocks" section
- [ ] Click on an IBA mock - should show your results

### For FBS Students:
- [ ] Login and navigate to `/results`
- [ ] Verify you see "DU FBS Mocks" section
- [ ] Verify you DO NOT see "IBA Mock Tests" section
- [ ] Click on a DU FBS mock - should show FBS passing criteria

### For Students with Both Access (e.g., Alex Alamgir):
- [ ] Login and navigate to `/results`
- [ ] Verify you see BOTH "IBA Mock Tests" AND "DU FBS Mocks"
- [ ] Click on IBA mock - should show IBA results
- [ ] Click on DU FBS mock - should show FBS results with passing criteria

## FBS Mock Test Format

### MCQ Sections (only attempted sections shown):
- **English** (16 questions) - Mandatory
- **Adv English** (12 questions) - Mandatory
- **Business Studies** (16 questions) - Optional (choose 2 of 3)
- **Accounting** (16 questions) - Optional (choose 2 of 3)
- **Economics** (16 questions) - Optional (choose 2 of 3)

### Written Sections (only attempted sections shown):
- **Essay** (10 marks) - Mandatory
- **Error Detection** (10 marks) - Mandatory
- **Business Studies Written** (10 marks) - Optional (matching MCQ choice)
- **Accounting Written** (10 marks) - Optional (matching MCQ choice)
- **Economics Written** (10 marks) - Optional (matching MCQ choice)

### Passing Criteria:
✅ English MCQ ≥ 5 marks
✅ Total MCQ ≥ 24 marks
✅ Total (MCQ + Written) ≥ 40 marks

## How to Add New Tests

### For IBA Tests:
1. Place Excel file in `Results/` folder (or appropriate subfolder)
2. Run `update-results.bat`
3. Tests automatically appear on website

### For FBS Mocks:
1. Place Excel file in `Results/DU FBS Mocks/` folder
2. Run `update-results.bat`
3. Tests automatically appear for users with FBS access

## Current Student Access Stats:
- **Total Students**: 34
- **FBS Access**: 30 students
- **IBA Access**: 24 students
- **Both IBA + FBS**: 20 students

## Example Students:

### Alex Alamgir (6040571)
- **Access**: IBA + FBS (Both)
- **Role Numbers**: [604057, 6040571]
- **Can See**: All IBA tests + All FBS mocks

### Aseya Siddiqua Saba (9342451)
- **Access**: FBS Only
- **Role Numbers**: [9342451]
- **Can See**: FBS mocks only

### Abrar Bin Masud (IBA ID)
- **Access**: IBA Only
- **Role Numbers**: [6-digit IBA ID]
- **Can See**: IBA tests only

## Troubleshooting

### If tests don't appear:
1. Check `public/data/fbs-mock-tests.json` exists
2. Verify Excel file is in correct folder
3. Re-run `update-results.bat`

### If admin can't see FBS tests:
1. Check `/api/user/access` returns `{hasIBA: true, hasFBS: true, isAdmin: true}`
2. Clear browser cache
3. Check console for errors

### If student access is wrong:
1. Run: `mongosh "YOUR_MONGODB_URI" scripts/check-fbs-students.js`
2. Verify `accessTypes` in database
3. Check `roleNumbers` array

## Files Generated by update-results.bat:
- `public/data/simple-tests.json` - Simple tests
- `public/data/full-tests.json` - Full tests
- `public/data/mock-tests.json` - IBA mock tests
- `public/data/fbs-mock-tests.json` - FBS mock tests
- `public/data/students.json` - Student records
- `public/data/metadata.json` - System metadata
